document.addEventListener('DOMContentLoaded', function ($) {
    const form_locais_json = JSON.parse(form_locais);
    if(jQuery('select.local_state').length > 0){
        
        //
        jQuery('select.local_state option').remove();
        jQuery('select.local_state').append('<option>Selecione</option>');

        jQuery(form_locais_json).each(function(index,elem){
            
            jQuery('select.local_state').append('<option value="'+elem.state+'">'+elem.state+'</option>');
        });
        //
        jQuery('select.local_city option').remove();
        jQuery('select.local_city').append('<option>Selecione</option>');
        
        console.log(form_locais_json);
        
    }
    jQuery('select.local_state').on('change',function(){
        jQuery('select.local_city option').remove();
        jQuery('select.local_city').append('<option>Selecione</option>');
        var selected = this.value;
        jQuery(form_locais_json).each(function(index,elem){
            console.log('selected:' + selected);
            if(elem.state == selected){
                jQuery(elem.cidades).each(function(i,e){
                    
                    jQuery('select.local_city').append('<option>'+e.cidade+'</option>');
                });
            }
        });
        
    })
}, false);